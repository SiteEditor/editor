/*
 jQuery Lazy Scroll Loading Plugin 0.4.5

 http://plugins.jquery.com/jQueryLazyScrollLoading/
 https://code.google.com/p/jquerylazyscrollloading/

 Apache License 2.0 - http://www.apache.org/licenses/LICENSE-2.0

 @author Dreamltf
 @date 2013/12/07

 Depends: jquery.js (1.2+)
*/
(function(k){function u(b,c){var a=b.getLazyScrollLoadingViewport(),f=a.getScrollBindTarget(),d=!1,m=null;f.bind("scroll."+e,function(a){0>=c.delay?p(a,b,c):d||(d=!0,null!=m&&clearTimeout(m),m=setTimeout(function(){p(a,b,c);clearTimeout(m);d=!1},c.delay))});(0>=a.getScrollTop()&&0>=a.getScrollLeft()||q&&9>v)&&f.trigger("scroll."+e)}function p(b,c,a){var f=c.getLazyScrollLoadingCachedLazyItems(),d=[],m=[],g=[];if(null!=a.lazyItemSelector&&((a.isDefaultLazyImageMode||null!=a.onLazyItemFirstVisible||
null!=a.onLazyItemVisible||null!=a.onLazyItemInvisible)&&f.each(function(){var a=k(this);a.isLazyScrollLoadingLazyItemVisible(c)?(a.data("isLoading."+e,!0),d.push(this),a.isLazyScrollLoadingLazyItemLoaded()||(a.data("isLoaded."+e,!0),m.push(this))):a.isLazyScrollLoadingLazyItemLoading()&&(a.removeData("isLoading."+e),g.push(this))}),a.isDefaultLazyImageMode))for(var h=0,l=m.length;h<l;h++){var r=m[h];r.src=r.getAttribute(s)}w(b,c,a,f,d,m,g)}function w(b,c,a,f,d,m,g){var h=c[0];null!=a.onScroll&&a.onScroll.apply(h,
[b]);if(null!=a.onScrollVertically||null!=a.onScrollUp||null!=a.onScrollDown||null!=a.onScrollToTop||null!=a.onScrollToBottom||null!=a.onScrollHorizontally||null!=a.onScrollLeft||null!=a.onScrollRight||null!=a.onScrollToLeftmost||null!=a.onScrollToRightmost){var l=c.getLazyScrollLoadingViewport(),k=l.getScrollTop(),p=l.getScrollLeft(),q={scrollTop:k,scrollLeft:p},n=[b,f];l.isVerticalScrollBarScrolling()&&(null!=a.onScrollVertically&&a.onScrollVertically.apply(h,n),null!=a.onScrollUp&&l.isScrollUp()&&
a.onScrollUp.apply(h,n),null!=a.onScrollDown&&l.isScrollDown()&&a.onScrollDown.apply(h,n),null!=a.onScrollToTop&&l.isScrollToTop()&&a.onScrollToTop.apply(h,n),null!=a.onScrollToBottom&&l.isScrollToBottom()&&a.onScrollToBottom.apply(h,n));l.isHorizontalScrollBarScrolling()&&(null!=a.onScrollHorizontally&&a.onScrollHorizontally.apply(h,n),null!=a.onScrollLeft&&l.isScrollLeft()&&a.onScrollLeft.apply(h,n),null!=a.onScrollRight&&l.isScrollRight()&&a.onScrollRight.apply(h,n),null!=a.onScrollToLeftmost&&
l.isScrollToLeftmost()&&a.onScrollToLeftmost.apply(h,n),null!=a.onScrollToRightmost&&l.isScrollToRightmost()&&a.onScrollToRightmost.apply(h,n));c.scrollTop(k);c.scrollLeft(p);c.data("scrollHistory."+e,q)}null!=a.onLazyItemFirstVisible&&0<m.length&&a.onLazyItemFirstVisible.apply(h,[b,f,c.pushStack(m)]);null!=a.onLazyItemVisible&&0<d.length&&a.onLazyItemVisible.apply(h,[b,f,c.pushStack(d)]);null!=a.onLazyItemInvisible&&0<g.length&&a.onLazyItemInvisible.apply(h,[b,f,c.pushStack(g)])}var e="LazyScrollLoading",
s="lazy-img",x={isDefaultLazyImageMode:!1,lazyItemSelector:null,delay:500,onCreate:null,onScroll:null,onLazyItemFirstVisible:null,onLazyItemVisible:null,onLazyItemInvisible:null,onScrollVertically:null,onScrollHorizontally:null,onScrollUp:null,onScrollDown:null,onScrollLeft:null,onScrollRight:null,onScrollToTop:null,onScrollToBottom:null,onScrollToLeftmost:null,onScrollToRightmost:null},t=navigator.userAgent.toLowerCase(),q=/msie/.test(t),v=q?parseFloat((t.match(/.*(?:rv|ie)[\/: ](.+?)([ \);]|$)/)||
[])[1]):-1;k.extend(k.fn,{lazyScrollLoading:function(b){b=k.extend({},x,b);b.isDefaultLazyImageMode&&null==b.lazyItemSelector&&(b.lazyItemSelector="img["+s+"]:not([src])");return this.each(function(){var c=k(this);c.destroyLazyScrollLoading();c.data("options."+e,b);u(c,b);null!=b.onCreate&&b.onCreate.apply(c[0])})},getLazyScrollLoadingOptions:function(){return this.data("options."+e)},getLazyScrollLoadingScrollHistory:function(){return this.data("scrollHistory."+e)},clearLazyScrollLoadingScrollHistory:function(){return this.removeData("scrollHistory."+
e)},getLazyScrollLoadingViewport:function(){var b=this,c=b[0],a=c==window||c==document||c==document.body,f=k(window),d=k(document),e=k(document.body),g=b.getLazyScrollLoadingScrollHistory();return{getOffset:function(){return a?e.offset():b.offset()},getScrollLeft:function(){return(a?f:b).scrollLeft()},getScrollTop:function(){return(a?f:b).scrollTop()},getScrollBindTarget:function(){return a?d:b},getWidth:function(c){return a?f.width():c?b.outerWidth():b.innerWidth()},getHeight:function(c){return a?
f.height():c?b.outerHeight():b.innerHeight()},getScrollWidth:function(b){return(a?d.width():c.scrollWidth)+(b&&this.isVerticalScrollBarVisible()?16:a?-1:0)},getScrollHeight:function(b){return(a?d.height():c.scrollHeight)+(b&&this.isHorizontalScrollBarVisible()?16:a?-1:0)},getLeftPos:function(){return a?this.getScrollLeft():this.getOffset().left},getTopPos:function(){return a?this.getScrollTop():this.getOffset().top},getRightPos:function(){return this.getLeftPos()+this.getWidth(!0)},getBottomPos:function(){return this.getTopPos()+
this.getHeight(!0)},isVerticalScrollBarVisible:function(){return this.getHeight(!1)<this.getScrollHeight(!1)},isHorizontalScrollBarVisible:function(){return this.getWidth(!1)<this.getScrollWidth(!1)},isVerticalScrollBarScrolling:function(){return this.isVerticalScrollBarVisible()?null!=g&&g.scrollTop!=this.getScrollTop():!1},isHorizontalScrollBarScrolling:function(){return this.isHorizontalScrollBarVisible()?null!=g&&g.scrollLeft!=this.getScrollLeft():!1},isScrollUp:function(){return this.isVerticalScrollBarVisible()?
null!=g&&g.scrollTop>this.getScrollTop():!1},isScrollDown:function(){return this.isVerticalScrollBarVisible()?null!=g&&g.scrollTop<this.getScrollTop():!1},isScrollLeft:function(){return this.isHorizontalScrollBarVisible()?null!=g&&g.scrollLeft>this.getScrollLeft():!1},isScrollRight:function(){return this.isHorizontalScrollBarVisible()?null!=g&&g.scrollLeft<this.getScrollLeft():!1},isScrollToTop:function(){return this.isVerticalScrollBarVisible()?0>=this.getScrollTop():!1},isScrollToBottom:function(){return this.isVerticalScrollBarVisible()?
this.getScrollTop()+this.getHeight(!1)>=this.getScrollHeight(!0):!1},isScrollToLeftmost:function(){return this.isHorizontalScrollBarVisible()?0>=this.getScrollLeft():!1},isScrollToRightmost:function(){return this.isHorizontalScrollBarVisible()?this.getScrollLeft()+this.getWidth(!1)>=this.getScrollWidth(!0):!1}}},getLazyScrollLoadingCachedLazyItems:function(b){return this.pushStack(k.map(this,function(c){var a=k(c),f=a.getLazyScrollLoadingOptions(),d=a.data("items."+e);null!=f&&null!=f.lazyItemSelector&&
null==d&&(d=k(f.lazyItemSelector,c==window||c==document||c==document.body?void 0:a),a.data("items."+e,d));null!=d&&null!=b&&(d=d.filter(b));return null!=d?d.get():null}))},clearLazyScrollLoadingCachedLazyItems:function(){return this.removeData("items."+e)},destroyLazyScrollLoading:function(){return this.each(function(){var b=k(this);b.getLazyScrollLoadingViewport().getScrollBindTarget().unbind("scroll."+e);b.getLazyScrollLoadingCachedLazyItems().removeData("isLoaded."+e);b.clearLazyScrollLoadingCachedLazyItems().clearLazyScrollLoadingScrollHistory().removeData("options."+
e)})},isLazyScrollLoadingLazyItemLoaded:function(){return this.data("isLoaded."+e)},isLazyScrollLoadingLazyItemLoading:function(){return this.data("isLoading."+e)},isLazyScrollLoadingLazyItemVisible:function(b){var c=this.getLazyScrollLoadingViewport();b=b.getLazyScrollLoadingViewport();return c.getBottomPos()>b.getTopPos()&&c.getLeftPos()<b.getRightPos()&&c.getTopPos()<b.getBottomPos()&&c.getRightPos()>b.getLeftPos()}})})(jQuery);
